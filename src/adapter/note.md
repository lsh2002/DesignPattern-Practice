# è®¾è®¡æ¨¡å¼ï¼šé€‚é…å™¨æ¨¡å¼ (Adapter Pattern)

### ğŸ’¡ æ ¸å¿ƒç†è§£ï¼šæ¥å£ä¸å¯¹ï¼Œéœ€è¦"è½¬æ¥å¤´"ï¼

æƒ³è±¡ä½ åˆšä¹°äº†ä¸€ä¸ªæœ€æ–°ã€æœ€å¼ºå¤§çš„è€³æœºï¼ˆType-C æ’å¤´ï¼‰ï¼Œä½ æƒ³æŠŠå®ƒæ’åˆ°ä½ çè—å¤šå¹´çš„è€å¼MP3æ’­æ”¾å™¨ï¼ˆåªæœ‰ 3.5mm è€³æœºå­”ï¼‰ä¸Šã€‚

*   **ä½ çš„æ–°è€³æœº (è¢«é€‚é…è€…/Adaptee)**ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œä½†æ¥å£æ˜¯ Type-Cã€‚
*   **ä½ çš„è€MP3 (ç›®æ ‡æ¥å£/Target)**ï¼šç¨³å®šå·¥ä½œï¼Œä½†åªè®¤ 3.5mm æ¥å£ã€‚
*   **é—®é¢˜**ï¼šæ¥å£ä¸å…¼å®¹ï¼Œä½ ä¸èƒ½ç›´æ¥ç”¨ã€‚
*   **ä½ çš„æ ¸å¿ƒéœ€æ±‚**ï¼šä½ æ—¢ä¸æƒ³æ”¹è€³æœºï¼Œä¹Ÿä¸æƒ³æ”¹MP3ï¼Œåªå¸Œæœ›å®ƒä»¬**ç°åœ¨å°±èƒ½ä¸€èµ·å·¥ä½œ**ã€‚

é‚£ä¸€åˆ»ï¼Œä½ è„‘æµ·é‡Œç«‹åˆ»é—ªè¿‡çš„"Type-C è½¬ 3.5mm çš„è½¬æ¥å¤´"ï¼Œå°±æ˜¯**é€‚é…å™¨æ¨¡å¼**ï¼

### ä»€ä¹ˆæ—¶å€™ä½ "ä¸€ä¸‹å­"å°±ä¼šæƒ³åˆ°å®ƒï¼Ÿ

å½“ä½ å†™ä»£ç æ—¶ï¼Œè„‘å­é‡Œæµ®ç°å‡ºä»¥ä¸‹åœºæ™¯ï¼Œé€‚é…å™¨æ¨¡å¼å°±è¯¥è·³å‡ºæ¥äº†ï¼š

1.  **"æˆ‘æœ‰ä¸¤ä¸ªç±»ï¼Œå®ƒä»¬çš„åŠŸèƒ½éƒ½å¾ˆå¥½ï¼Œä½†æ˜¯å®ƒä»¬çš„æ¥å£å¯¹ä¸ä¸Šï¼"**
    *   ä¸€ä¸ªç±»æä¾› `processData(String input)`ï¼Œå¦ä¸€ä¸ªç±»æœŸæœ› `handleInput(byte[] data)`ã€‚
    *   ä½ æœ‰ä¸€ä¸ªæ—§çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå®ƒæœ‰ä¸€ä¸ª `OldApi.doSomething()` æ–¹æ³•ï¼Œä½†ä½ çš„æ–°ç³»ç»Ÿåªè®¤è¯† `NewApi.execute()`ã€‚

2.  **"æˆ‘ä¸èƒ½æˆ–è€…ä¸æƒ³ä¿®æ”¹è¿™ä¸¤ä¸ªç°æœ‰çš„ç±»ï¼"**
    *   æ—§çš„ç±»å¯èƒ½æ˜¯é—ç•™ä»£ç ï¼Œä¿®æ”¹å®ƒé£é™©é«˜ã€æˆæœ¬å¤§ã€‚
    *   æ–°çš„æ¥å£å¯èƒ½æ˜¯ç³»ç»Ÿæ ‡å‡†ï¼Œä¸èƒ½éšæ„æ”¹åŠ¨ã€‚
    *   ç¬¬ä¸‰æ–¹åº“çš„ä»£ç ä½ æ ¹æœ¬æ²¡æƒé™æ”¹ã€‚

å½“ä½ é¢ä¸´"æ¥å£ä¸å…¼å®¹"å’Œ"ä¸èƒ½/ä¸æƒ³ä¿®æ”¹ç°æœ‰ä»£ç "è¿™ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œé€‚é…å™¨æ¨¡å¼å‡ ä¹å°±æ˜¯å”¯ä¸€çš„ä¼˜é›…è§£å†³æ–¹æ¡ˆã€‚

å®ƒè®©ä½ åœ¨ä¸ä¾µå…¥ç°æœ‰ä»£ç ç»“æ„çš„å‰æä¸‹ï¼Œå¹³æ»‘åœ°æ•´åˆä¸åŒæ¥å£çš„åŠŸèƒ½ï¼Œå®ç°"å³æ’å³ç”¨"çš„æ•ˆæœã€‚

## æ ¸å¿ƒæ€æƒ³ä¸è§£å†³çš„é—®é¢˜

*   **é—®é¢˜**: ä½ æœ‰ä¸€ä¸ªç°æœ‰çš„ã€åŠŸèƒ½å¼ºå¤§çš„ç±»ï¼ˆ**è¢«é€‚é…è€… Adaptee**ï¼‰ï¼Œä½†å®ƒçš„æ¥å£ï¼ˆæ–¹æ³•åã€å‚æ•°ç­‰ï¼‰ä¸ä½ å½“å‰ç³»ç»Ÿæ‰€æœŸæœ›çš„æ¥å£ï¼ˆ**ç›®æ ‡ Target**ï¼‰ä¸åŒ¹é…ã€‚ä½ ä¸æƒ³æˆ–ä¸èƒ½ä¿®æ”¹ç°æœ‰ç±»ã€‚
*   **è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºä¸€ä¸ª**é€‚é…å™¨ (Adapter)** ç±»ã€‚è¿™ä¸ªé€‚é…å™¨ç±»å®ç°ä½ ç³»ç»Ÿæ‰€éœ€çš„`Target`æ¥å£ï¼Œä½†åœ¨å†…éƒ¨ï¼Œå®ƒä¼šå»è°ƒç”¨é‚£ä¸ª`Adaptee`ç±»çš„æ–¹æ³•æ¥å®Œæˆå®é™…å·¥ä½œã€‚è¿™æ ·ï¼Œå®¢æˆ·ç«¯ä»£ç å°±å¯ä»¥é€šè¿‡æ ‡å‡†çš„`Target`æ¥å£æ¥ä½¿ç”¨`Adaptee`äº†ã€‚

### å…·ä½“åº”ç”¨åœºæ™¯ï¼šåœ¨"ç­–ç•¥æ¨¡å¼"ä¸­å…¼å®¹ç¬¬ä¸‰æ–¹æ¥å£

> **æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªéå¸¸æ·±åˆ»ä¸”å¸¸è§çš„åœºæ™¯ï¼Œå®ƒä½“ç°äº†**é€‚é…å™¨æ¨¡å¼**ä¸**ç­–ç•¥æ¨¡å¼**çš„ç»“åˆä½¿ç”¨ã€‚

æƒ³è±¡ä½ çš„ç”µå•†å¹³å°éœ€è¦é›†æˆå¤šç§ç¬¬ä¸‰æ–¹æ”¯ä»˜æœåŠ¡ï¼ˆå¦‚æ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ã€PayPalï¼‰ï¼Œå¹¶å…è®¸ç”¨æˆ·åœ¨è¿è¡Œæ—¶é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§ã€‚

*   **ä»è¡Œä¸ºä¸Šçœ‹ï¼Œè¿™æ˜¯"ç­–ç•¥æ¨¡å¼"**: ç³»ç»Ÿæœ‰å¤šç§æ”¯ä»˜**ç­–ç•¥**ï¼Œå®¢æˆ·ç«¯ï¼ˆè®¢å•æœåŠ¡ï¼‰å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©å…¶ä¸­ä¸€ç§æ¥æ‰§è¡Œ"æ”¯ä»˜"è¿™ä¸ª**è¡Œä¸º**ã€‚å› æ­¤ï¼Œç³»ç»Ÿåº”è¯¥å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„ç­–ç•¥æ¥å£ï¼Œå¦‚ `PaymentStrategy`ã€‚

*   **ä»æ¥å£å…¼å®¹ä¸Šçœ‹ï¼Œè¿™æ˜¯"é€‚é…å™¨æ¨¡å¼"**: æ¯ä¸ªç¬¬ä¸‰æ–¹æ”¯ä»˜SDKï¼ˆ`AlipaySDK`, `WechatPaySDK`ï¼‰çš„æ¥å£éƒ½æ˜¯ç‹¬ç‰¹çš„ï¼Œä¸æˆ‘ä»¬ç³»ç»Ÿå†…éƒ¨å®šä¹‰çš„ `PaymentStrategy` æ¥å£ä¸å…¼å®¹ã€‚æˆ‘ä»¬æ— æ³•ä¿®æ”¹ç¬¬ä¸‰æ–¹SDKçš„ä»£ç ã€‚

*   **è§£å†³æ–¹æ¡ˆ**: ä¸ºæ¯ä¸€ç§æ”¯ä»˜æ–¹å¼åˆ›å»ºä¸€ä¸ª**é€‚é…å™¨**ï¼Œè®©è¿™ä¸ªé€‚é…å™¨**åŒæ—¶å®ç°**æˆ‘ä»¬çš„`PaymentStrategy`æ¥å£ã€‚

    ```java
    // AlipayAdapter åŒæ—¶æ˜¯"é€‚é…å™¨"ä¹Ÿæ˜¯ä¸€ä¸ª"ç­–ç•¥"
    public class AlipayAdapter implements PaymentStrategy {
        private AlipaySDK adaptee = new AlipaySDK(); // è¢«é€‚é…è€…

        @Override
        public void pay(BigDecimal amount) {
            // å°†æˆ‘ä»¬ç³»ç»Ÿçš„æ ‡å‡†è°ƒç”¨ï¼Œé€‚é…æˆæ”¯ä»˜å®SDKçš„ç‹¬ç‰¹è°ƒç”¨
            adaptee.specialPay(amount, "CNY", "your_partner_id");
        }
    }
    ```
    è¿™æ ·ï¼Œä½ çš„ç”µå•†å¹³å°ä¸šåŠ¡é€»è¾‘å°±åªä¸ç»Ÿä¸€çš„ `PaymentStrategy` æ¥å£äº¤äº’ï¼ˆç­–ç•¥æ¨¡å¼çš„ä¼˜åŠ¿ï¼‰ï¼ŒåŒæ—¶é€šè¿‡é€‚é…å™¨ä¼˜é›…åœ°å…¼å®¹äº†å„ç§å¤–éƒ¨æ¥å£ï¼ˆé€‚é…å™¨æ¨¡å¼çš„ä¼˜åŠ¿ï¼‰ã€‚

## æ¨¡å¼ä¸­çš„è§’è‰²

1.  **ç›®æ ‡æ¥å£ (Target)**: å®¢æˆ·ç«¯æ‰€æœŸæœ›ä½¿ç”¨çš„æ¥å£ã€‚ (`NewLogger`)
2.  **è¢«é€‚é…è€… (Adaptee)**: å·²æœ‰çš„ã€åŠŸèƒ½ç¬¦åˆä½†æ¥å£ä¸å…¼å®¹çš„ç±»ã€‚ (`LegacyLogger`)
3.  **é€‚é…å™¨ (Adapter)**: å®ç°`ç›®æ ‡æ¥å£`ï¼Œå¹¶æŒæœ‰ä¸€ä¸ª`è¢«é€‚é…è€…`çš„å®ä¾‹ã€‚å®ƒè´Ÿè´£å°†`ç›®æ ‡æ¥å£`çš„è°ƒç”¨è½¬æ¢æˆ`è¢«é€‚é…è€…`å¯ä»¥ç†è§£çš„è°ƒç”¨ã€‚ (`LoggerAdapter`)
4.  **å®¢æˆ·ç«¯ (Client)**: ä¸`ç›®æ ‡æ¥å£`è¿›è¡Œäº¤äº’ï¼Œé€šè¿‡`ç›®æ ‡æ¥å£`ä½¿ç”¨`è¢«é€‚é…è€…`çš„åŠŸèƒ½ã€‚

## ä»£ç ç¤ºä¾‹

### 1. ç›®æ ‡æ¥å£: NewLogger.java

```java
package adapter;

public interface NewLogger {
    void info(String message);
    void error(String message);
}
```

### 2. è¢«é€‚é…è€…: LegacyLogger.java

```java
package adapter;

public class LegacyLogger {
    public void log(int level, String text) {
        if (level == 1) {
            System.out.println("[LEGACY INFO] " + text);
        } else if (level == 2) {
            System.out.println("[LEGACY ERROR] " + text);
        } else {
            System.out.println("[LEGACY UNKNOWN] " + text);
        }
    }
}
```

### 3. é€‚é…å™¨: LoggerAdapter.java

```java
package adapter;

public class LoggerAdapter implements NewLogger {
    private LegacyLogger legacyLogger;

    public LoggerAdapter(LegacyLogger legacyLogger) {
        this.legacyLogger = legacyLogger;
    }

    @Override
    public void info(String message) {
        legacyLogger.log(1, message); // é€‚é…è°ƒç”¨
    }

    @Override
    public void error(String message) {
        legacyLogger.log(2, message); // é€‚é…è°ƒç”¨
    }
}
```

### 4. å®¢æˆ·ç«¯: Main.java

```java
package adapter;

public class Main {
    public static void main(String[] args) {
        // åˆ›å»ºè¢«é€‚é…è€…å®ä¾‹
        LegacyLogger legacyLogger = new LegacyLogger();
        
        // åˆ›å»ºé€‚é…å™¨ï¼Œå¹¶å°†å…¶ä½œä¸ºç›®æ ‡æ¥å£ä½¿ç”¨
        NewLogger newLogger = new LoggerAdapter(legacyLogger);

        // å®¢æˆ·ç«¯é€šè¿‡ç›®æ ‡æ¥å£ä½¿ç”¨åŠŸèƒ½ï¼Œæ— éœ€å…³å¿ƒåº•å±‚å®ç°ç»†èŠ‚
        newLogger.info("è¿™æ˜¯é€‚é…å™¨æ¨¡å¼çš„ä¿¡æ¯æ—¥å¿—ã€‚");
        newLogger.error("è¿™æ˜¯é€‚é…å™¨æ¨¡å¼çš„é”™è¯¯æ—¥å¿—ã€‚");
    }
}
```